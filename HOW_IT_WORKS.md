  #### איך למדוד חזרתיות בטקסט?
  בהשראת [מאמר שעשה ניתוח דומה באנגלית,](https://pudding.cool/2017/05/song-repetition/) בחרנו להתמקד בגישה פשוטה - מדידת החזרתיות בטקסט על פי המידה שבה ניתן לדחוס אותו, בשימוש באלגוריתמי כיווץ סטנדרטיים.
  אלגוריתמים כאלה, כמו אלגוריתם [DEFLATE](https://he.wikipedia.org/wiki/Gzip), משמשים בתוכנות דחיסה כמו Winzip, ואפשר לחלק אותם לשני חלקים:  
  
  1. צמצום אורך הטקסט על ידי זיהוי חזרות, ומתן הפנייה למקום קודם במקום העתקה מחדש.  
  למשל, המשפט "אין אין אין חגיגה, בלי בלי בלי בלי עוגה" יכול להיכתב בתור "אין (1-3)2x חגיגה, בלי (20-22)3x עוגה", כאשר המשמעות היא שניקח את התווים ממקום 1 עד 3 ונשכפל אותם פעמיים, ואת התווים בין 20 ל-22 ונשכפל אותם 3 פעמים.  
  במקרה הזה החיסכון קטן, אבל במשפט המלא  החיסכון כבר משמעותי:  
  "אין (1-3)2x חגיגה, בלי (20-22)3x עוגה, איפה (42-45)12x ה(36-39)" - חיסכון של כמעט 50% בהשוואה לטקסט הלא מכווץ.  
  אחד האלגוריתמים הכי שימושיים לזיהוי יעיל של חזרות כאלה הוא [אלגוריתם למפל-זיו](https://he.wikipedia.org/wiki/%D7%90%D7%9C%D7%92%D7%95%D7%A8%D7%99%D7%AA%D7%9D_%D7%9C%D7%9E%D7%A4%D7%9C-%D7%96%D7%99%D7%95) (כבוד למגזר!), ואנחנו התבססנו עליו ומימשנו אלגוריתם דומה.  
  2. איכסון יותר יעיל של תווים בודדים באמצעות [קידוד האפמן](https://he.wikipedia.org/wiki/%D7%A7%D7%95%D7%93_%D7%94%D7%90%D7%A4%D7%9E%D7%9F).  
  בחרנו לממש רק זיהוי חזרות ולא קידוד האפמן, שבעינינו לוכד פחות טוב את הרעיון של זיהוי טקסט חזרתי.  

יש גישות מתוחכמות יותר לזיהי טקסט חזרתי. [סיבוכיות קולמוגורוב](https://he.wikipedia.org/wiki/%D7%A1%D7%99%D7%91%D7%95%D7%9B%D7%99%D7%95%D7%AA_%D7%A7%D7%95%D7%9C%D7%9E%D7%95%D7%92%D7%95%D7%A8%D7%95%D7%91) של טקסט מוגדרת להיות האורך של המשפט הכי קצר שמסביר איך לייצר את הטקסט (או לחילופין, קטע הקוד הקצר ביותר שמייצר אותו).
למשל בטקסט "אבגדהוזחטיכלמנסעפצקרשת" אין חזרות, אבל אפשר להסביר את כולו במשפט הקצר "הא-ב לפי הסדר". אפשר לומר שזו דרך טובה למדוד כמה טקסט מסוים הוא בנאלי.
למרבה הצער מציאת סיבוכיות קולמוגורוב של טקסט היא בעיה הרבה יותר מסובכת מכיווץ, ולמחשב יקח הרבה יותר מדי זמן להגיע לתשובה. אבל נכון שזה מעניין?  
  
יש גם גישות משודרגות שמתבססות על הבנה גדולה יותר של שפת הטקסט. בעברית למשל אפשר להגיד ששיר שמשתמש בהמון מילים עם השורש א.ה.ב הוא שיר חסר יצירתיות, גם אם הוא לא חוזר על עצמו בכלל ("אוהב לאהוב אותך אהבה שלי").
 בכלל, בתחום של עיבוד שפה טבעית יש הרבה כלים שיכולים לעזור בניתוח כזה, אבל בינתיים לא השתמשנו בהם.
  
 #### זיהוי דפוסים של חזרות
  בפרק על דפוסי חזרה, אנחנו בתכלס [מחפשים קורלציות של השיר מול עצמו](https://en.wikipedia.org/wiki/Cross-correlation).
  שירים הם יחסית קצרים, ובמקרה הזה זמן החישוב לא מהווה מגבלה אמיתית. אבל נניח שיש לנו טקסט ארוך, עם חזרות מסוגים שונים, ואנחנו רוצים לאסוף מידע האלמנטים החוזרים בו.
  תדמיינו שיש לנו שני עותקים של השיר S, ואנחנו מחליקים אחד מהם על גבי השני, ושואלים את עצמנו לכל הזזה בכמה מילים S חופף ל-S+t. אם יש הרבה כאלה, כנראה שיש אלמנט חוזר, שבין שתי הופעות שלו יש t מילים.
  זו בעיה קלאסית, כאשר האלגוריתם הנאיבי שתחשבו עליו יבצע את המשימה בזמן O(n²) (בהנחה שאורך המילים קבוע).  
  למזלנו, יש אלגוריתם יותר טוב המבוסס על [טרנספורם פורייה](https://he.wikipedia.org/wiki/FFT), העושה זאת בזמן O(n log n).
  ואם אתם שואלים את עצמכם מה הקשר בין מילים שחוזרות על עצמן לשיטה מתמטית לעיבוד אותות, אתם לא לבד. אבל השיטה הזו, והאלגוריתם המהיר שמחשב אותה, מופיעים בהמון בעיות מעניינות - עיבוד שמע, זיהוי חפצים בתמונה, ואפילו כפל מהיר של מספרים ענקיים.


#### מאיפה הכל התחיל
לפני שנים נתקלנו במאמר הומוריסטי של Donald Knuth, על [הסיבוכיות החישובית של שירים](https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.435.7698&rep=rep1&type=pdf).  
המאמר מיישם קונספטים מלימודי מדעי המחשב על שירים שכולנו גדלנו עליהם, ואפילו מזכיר כדוגמא את השיר "אחד מי יודע".
הקריאה מומלצת לכל מי שיודע מה זה סיבוכיות חישובית.  
כמחווה למאמר של Knuth, הוספנו בפרק 'דפוסי חזרה אומנותיים' את השירים שהוא ניתח במאמר שלו ("אחד מי יודע", "לדוד משה הייתה חווה").  
  
  אם אתם רוצים לראות את הקוד או להציע שינויים, אפשר למצוא אותו ב-GitHub:  
  https://github.com/gevak/glglstats